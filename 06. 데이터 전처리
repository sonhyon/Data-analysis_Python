*pandas는 데이터 전처리에 가장 많이 사용되는 패키지이다
*pandas 함수 : query(), df[], sort_values(), groupby(), assign(), agg(), merge(), concat()

#행 추출
exam.query('nclass == 1") 
exam.query('nclass == 1 & math > 50')
exam.query('math >= 90 | english >= 90')
exam.query('nclass == 1 | nclass == 3 | nclass ==5')
exam.query('nclass in [1, 3, 5]') #한꺼번에 표현 가능

*파이썬에서 사용하는 기호
논리 연산자 : <, <=, >, >=, ==, !=, |, &, in
산술 연산자 : +, -, *, **, /, //, %

#변수 추출하기
exam['math'] 
exam[['nclass', 'math', 'english']] #여러 변수 추출
exam[['math']] #데이터 프레임 유지하기

#변수 제거하기
exam.drop(columns = 'math')
exam.drop(columns = ['math', 'english'])

exam.query('nclass == 1')['english'] #1반의 영어 성적을 확인 가능
exam.query('nclass == 1')['english'].head() #일부만 추출
exam.query('nclass == 1') \ #가독성 있게 백슬래시 입력
    [['english']] \
    .head()

#정렬하기
exam.sort_values('math') #오름차순
exam.sort_values('math', ascending = False) #내림차순
exam.sort_values(['nclass', 'math']) #여러 정렬 기준 적용
exam.sort_values(['nclass', 'math'], ascending = [True, False])

#파생변수 추가
exam.assign(total = exam['math'] + exam['english'] + exam['science']
exam.assign(
    total = exam['math'] + exam['english'] + exam['science'], #여러 파생변수 추가
    mean = (exam['math'] + exam['english'] + exam['science'])/3)

exam.assign(test = np.where(exam['science'] > 60, "pass", "fail"))
exam.assign(test = np.where(exam['science'] > 60, "pass", "fail")).sort_values('total')

long_name.assign(new = lambda x: x['math'] + x['english'] + x['science']) #데이터프레임명을 반복해서 적기에 번거로우므로 약어를 사용해 코드를 간결히 표현한다

